---
title: "Your digital notebook"
author: "Mark Sterken"
date: "2026-02-05"
format:
  html:
    toc: true
    toc-depth: 3
    code-fold: true
    code-tools: true
editor: visual
execute:
  eval: false
  warning: false
  message: false
---

## Your digital notebook

### Introduction to day 3

Today we will continue with goal 1 (Built basic knowledge on using R and R studio) and goal 3 (Apply common statistical tools for inspecting and analyzing data). We will also start with goal 4 (Be able to document your code in a clear & concise way). You will find out that we've already covered this by requiring you to write a script. Now we'll add one more layer to it, the notebook.

New today, is that you get an assignment. In this assignment, you are expected to go over goal 5 \[(Apply the data-science cycle (load, inspect, ~~clean~~, analyse, present)\]. Also, this is not new, we've been doing it for the past two days.

As on the previous days, we will be making use of a real data-case.

::: {.callout-tip appearance="simple"}
### Plant growth impairment by nematodes.

You already know that plant susceptibility to nematodes is a complex trait, with a lot of variation in susceptibility between individuals of the same species. This variation also exists for the dose-response relation between plants and nematodes. The data you will be using today is derived from a study by Jaap-Jan Willig, who used a camera platform to track the growth of 960 *A. thaliana* plants simultaneously[@Willig2023].

![The relationship between the inoculation density (P~i~) of *H. schachtii* and green canopy area (relative yield). Nine-day-old Arabidopsis seedlings were inoculated with 20 different densities of *H. schachtii* juveniles (0--100 J2s g^--1^ of dry sand) in 200 ml pots containing 200 g of dry sand. (A) Experimental set up and colour channel decomposition of photos to extract the green leaf surface from the images. (B) Average growth curve of Arabidopsis plants inoculated with different inoculum densities of *H. schachtii* from 0 to 21 dpi. Line fitting was based on a LOESS regression. The red box indicates the data that are used for fitting the Seinhorst yield loss equation (n=10--24). (C) Fitting according to the Seinhorst yield loss equation. Parameter values for Seinhorst's equation for the relationship between initial population density (P~i~) of *H. schachtii* and measured leaf surface area. P~i~ and tolerance limit (TSYLM) are expressed in *H. schachtii* (per g of dry sand) while, the minimal yield (m) is the lowest proportion of the maximum green canopy area (cm^2^) (Ymax) at 21 dpi. The goodness of fit of the model on the data is expressed as the coefficient of determination (R^2^).](Week1_day3_Willig.jpeg)

The goal of this research was to develop a platform that allowed us to track in real-time plant growth under below-ground biotic stress caused by nematode infection. Doing this experiment, we identified a compensation response where, at low levels of infection, plants perform better than in uninfected conditions.
:::

### Set up your R environment

For the basics of setting up your environment, you can check [Chapter 1](/week1/day1.qmd).

### Quarto markdown

#### The use of a markdown document
The last two days you have been working with .qmd files ([Quarto markdown](https://quarto.org/docs/guide/)). This is a flavor of markdown, which is a markup language that relies on simple text to produce a layout of a document. As you have a lab-journal for experimental work in the field, greenhouse, or laboratory, a markdown notebook is useful to have when writing code.

The Quarto markdown file you make today, should be handed in on [Brightspace](https://brightspace.wur.nl/) today, before the deadline. You hand in the .qmd file. Your reviewer will go through the file and check if it renders and whether your conclusions are correct.

::: {#exr-MakeQmd}
#### Make your own markdown file
In RStudio go to File > New File > Quarto document...

Based on the documents provided last two days ([Chapter 1](/week1/day1.qmd) and [Chapter 2](/week1/day2.qmd)), make your own markdown file. Include meta information (title, name, registration number) and headings for: setup of the R environment (working directory, packages), and the five steps in the data analysis cycle (see [Chapter 1](/week1/day1.qmd)).

You can choose whether it renders a .html or a .pdf document. For now, settle on .html, this typically renders well and does not require additional programs.

:::

::: {.callout-tip appearance="simple"}
Typically, when you make a markdown file, you can make errors. RStudio tries to make you aware of these errors by putting a notification at the line numbers. But some errors you only catch when you render the document. Or when you run code line-by-line.

Many errors were made by me - and the other teachers - in building the book you are now reading. Do ask us about our frustrations in working with R.
:::


### How to do code-review







## Analysis of plant-growth data

Today we want to cover one more aspect of data analysis, namely including the fit of a simple model into a plot. In this case, we will use some plant-growth data. And to be precise, we will use the linear part of the growth curve. It is perfectly possible to fit a growth-model within R, but we want to start a bit simpler with an actual linear curve. you can find the data for this assignment via the fileshare on [Brightspace](https://brightspace.wur.nl/). You need the general file for everyone, not your personal dataset for the code-review assignment.

::: {#exr-loadxlsx}
### Load the data

Load the data using `readxl::read_xlsx()`. If you forgot how to, go back to [Chapter 2](/week1/day2.qmd).

```{r w1d2_load_xlsx, include = TRUE,eval=FALSE, class.source = 'fold-show'}
#| code-fold: false

    ### Packages (you need a package for the function)


    # Replace with the path to your Excel file
    pheno_data <- ### here add the code to read the data

```
:::

### Inspecting data

#### Inspecting data using functions

Inspect the data using the same functions as in [Chapter 2](/week1/day2.qmd).

```{r w1d2_check_the_data, include = TRUE,eval=FALSE}

    head(pheno_data)
    tail(pheno_data)
    summary(pheno_data)
    length(pheno_data)
    ncol(pheno_data)
    nrow(pheno_data)
    dim(pheno_data)
    
```

::: {#exr-headtail}
#### Inspecting data

Answer these three questions: (1) What do the `head()` and (2) `tail()` function tell you about an object? (3) If you would not know this, what is the command you could execute within the R console to find out?
:::

### Cleaning and preparing the data

Not needed here today. We keep it in for completeness though.

### Analyzing

Now the fun starts. We pick up on our old friend `cor()`. To determine which kind of correlation we need to perform, we need to figure out the statistical distribution of the data.

#### Normal distribution

Same as before, let's figure out whether the data is normally distributed. If you don't know the two tests anymore, check back at [Chapter 2](/week1/day2.qmd).

```{r w1d2_qqplot_pallida_ASSIGNMENT, include = TRUE,eval=FALSE}

    ###Use the graphical method


    ###Use the statistical method

```

::: {#exr-normal_dist}
#### Does the data follow a normal distribution?

You now conducted two types of analyses that tell you whether the data is normally distributed. What is your assessment, is it normally distributed?
:::

#### Analysis of correlation

Yesterday we conducted an analysis of correlation using the `cor()` function. There is actually another way to conduct this type of analysis, namely using a linear model with `lm()`. The advantage of this method is that we will get a slope and an intercept.

We can use the function `summary()` to get the fit of the model.

```{r w1d2_gather_pallida, include = TRUE,eval=FALSE, class.source = 'fold-show'}

    data.test <- pheno_data
    
    ### here the linear model is done
    tested <- lm(Area~day,data=data.test)
    
    ### use summary to get the fit
    summary(tested)
    
    

```

### Presenting

Now, let's make a proper plot of correlation.

```{r w1d2_wilcoxplot_pallida_ASSIGNMENT, include = TRUE,eval=FALSE}

    data.plot <- pheno_data

    ###I'm getting the statistics here
    statplot <- broom::tidy(summary(lm(Area~day,data=data.plot)))

    ggplot(data.plot, aes(x = day, y = Area)) 
    geom_point() + geom_smooth(method = "lm") + 
    theme_bw() + annotate("text", 
                          x=1.5, 
                          y=max(data.plot$Area), 
                          label=paste("p =", signif(statplot$p.value[2], 2)))

```

## Assignment for code-review week 1

Via the fileshare on [Brightspace](https://brightspace.wur.nl/), you can find your dataset for the code review. We expect that you hand in a Quarto markdown (QMD) file where you provide the code to:

1.  Load the data
2.  Inspect the data
3.  Analyse the data
4.  Present the data
